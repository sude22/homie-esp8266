



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="The Homie for ESP8266 documentation.">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>C++ API reference - Homie for ESP8266</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.1b62728e.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#ef5350">
      
    
    
      <script src="../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#homie" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Homie for ESP8266" class="md-header-nav__button md-logo">
          
            <img src="../../assets/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Homie for ESP8266
            </span>
            <span class="md-header-nav__topic">
              
                C++ API reference
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/homieiot/homie-esp8266/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    homieiot/homie-esp8266
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." class="md-tabs__link">
        Welcome
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../quickstart/what-is-it/" class="md-tabs__link">
          Quickstart
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../advanced-usage/built-in-led/" class="md-tabs__link">
          Advanced usage
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../configuration/json-configuration-file/" class="md-tabs__link">
          Configuration
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../ota-configuration-updates/" class="md-tabs__link md-tabs__link--active">
          Others
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Homie for ESP8266" class="md-nav__button md-logo">
      
        <img src="../../assets/logo.png" width="48" height="48">
      
    </a>
    Homie for ESP8266
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/homieiot/homie-esp8266/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    homieiot/homie-esp8266
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Welcome" class="md-nav__link">
      Welcome
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Quickstart
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Quickstart
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../quickstart/what-is-it/" title="What is it?" class="md-nav__link">
      What is it?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../quickstart/getting-started/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Advanced usage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Advanced usage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/built-in-led/" title="Built-in LED" class="md-nav__link">
      Built-in LED
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/branding/" title="Branding" class="md-nav__link">
      Branding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/events/" title="Events" class="md-nav__link">
      Events
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/logging/" title="Logging" class="md-nav__link">
      Logging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/streaming-operator/" title="Streaming operator" class="md-nav__link">
      Streaming operator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/input-handlers/" title="Input handlers" class="md-nav__link">
      Input handlers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/broadcast/" title="Broadcast" class="md-nav__link">
      Broadcast
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/custom-settings/" title="Custom settings" class="md-nav__link">
      Custom settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/resetting/" title="Resetting" class="md-nav__link">
      Resetting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/compiler-flags/" title="Compiler-Flags" class="md-nav__link">
      Compiler-Flags
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/standalone-mode/" title="Standalone mode" class="md-nav__link">
      Standalone mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/magic-bytes/" title="Magic bytes" class="md-nav__link">
      Magic bytes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/range-properties/" title="Range properties" class="md-nav__link">
      Range properties
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/deep-sleep/" title="Deep sleep" class="md-nav__link">
      Deep sleep
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/miscellaneous/" title="Miscellaneous" class="md-nav__link">
      Miscellaneous
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/ui-bundle/" title="UI Bundle" class="md-nav__link">
      UI Bundle
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Configuration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../configuration/json-configuration-file/" title="JSON configuration file" class="md-nav__link">
      JSON configuration file
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../configuration/http-json-api/" title="HTTP JSON API" class="md-nav__link">
      HTTP JSON API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Others
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Others
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ota-configuration-updates/" title="OTA/configuration updates" class="md-nav__link">
      OTA/configuration updates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../homie-implementation-specifics/" title="Homie implementation specifics" class="md-nav__link">
      Homie implementation specifics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../limitations-and-known-issues/" title="Limitations and known issues" class="md-nav__link">
      Limitations and known issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        C++ API reference
      </label>
    
    <a href="./" title="C++ API reference" class="md-nav__link md-nav__link--active">
      C++ API reference
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions-to-call-before-homiesetup" class="md-nav__link">
    Functions to call before Homie.setup()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions-to-call-after-homiesetup" class="md-nav__link">
    Functions to call after Homie.setup()
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../upgrade-guide-from-v1-to-v2/" title="Upgrade guide from v1 to v2" class="md-nav__link">
      Upgrade guide from v1 to v2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../upgrade-guide-from-v2-to-v3/" title="Upgrade guide from v2 to v3" class="md-nav__link">
      Upgrade guide from v2 to v3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../community-projects/" title="Community projects" class="md-nav__link">
      Community projects
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions-to-call-before-homiesetup" class="md-nav__link">
    Functions to call before Homie.setup()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions-to-call-after-homiesetup" class="md-nav__link">
    Functions to call after Homie.setup()
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/homieiot/homie-esp8266/edit/master/docs/others/cpp-api-reference.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="homie">Homie<a class="headerlink" href="#homie" title="Permanent link">&para;</a></h1>
<p>You don't have to instantiate an <code class="codehilite"><span class="err">Homie</span></code> instance, it is done internally.</p>
<div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="nf">setup</span><span class="p">();</span>
</pre></div>

<p>Setup Homie.</p>
<div class="admonition warning">
<p class="admonition-title">Mandatory!</p>
<p>Must be called once in <code class="codehilite"><span class="err">setup()</span></code>.</p>
</div>
<div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="nf">loop</span><span class="p">();</span>
</pre></div>

<p>Handle Homie work.</p>
<div class="admonition warning">
<p class="admonition-title">Mandatory!</p>
<p>Must be called once in <code class="codehilite"><span class="err">loop()</span></code>.</p>
</div>
<h2 id="functions-to-call-before-homiesetup">Functions to call <em>before</em> <code class="codehilite"><span class="err">Homie.setup()</span></code><a class="headerlink" href="#functions-to-call-before-homiesetup" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="nf">Homie_setFirmware</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">version</span><span class="p">);</span>
<span class="c1">// This is not a typo</span>
</pre></div>

<p>Set the name and version of the firmware.
This is useful for OTA, as Homie will check against the server if there is a newer version.
Be aware, that the function is implemented as a <code class="codehilite"><span class="err">define</span></code> macro.
If you want to define the name or version outside the function call, you need to do so in the form of a <code class="codehilite"><span class="err">define</span></code> as well. </p>
<div class="admonition warning">
<p class="admonition-title">Mandatory!</p>
<p>You need to set the firmware for your sketch to work.</p>
</div>
<ul>
<li><strong><code class="codehilite"><span class="err">name</span></code></strong>: Name of the firmware. Default value is <code class="codehilite"><span class="err">undefined</span></code></li>
<li><strong><code class="codehilite"><span class="err">version</span></code></strong>: Version of the firmware. Default value is <code class="codehilite"><span class="err">undefined</span></code></li>
</ul>
<div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="nf">Homie_setBrand</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">);</span>
<span class="c1">// This is not a typo</span>
</pre></div>

<p>Set the brand of the device, used in the configuration AP, the device hostname and the MQTT client ID.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">name</span></code></strong>: Name of the brand. Default value is <code class="codehilite"><span class="err">Homie</span></code></li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">Homie</span><span class="o">&amp;</span> <span class="n">disableLogging</span><span class="p">();</span>
</pre></div>

<p>Disable Homie logging.</p>
<div class="codehilite"><pre><span></span><span class="n">Homie</span><span class="o">&amp;</span> <span class="n">setLoggingPrinter</span><span class="p">(</span><span class="n">Print</span><span class="o">*</span> <span class="n">printer</span><span class="p">);</span>
</pre></div>

<p>Set the Print instance used for logging.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">printer</span></code></strong>: Print instance to log to. By default, <code class="codehilite"><span class="err">Serial</span></code> is used</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It's up to you to call <code class="codehilite"><span class="err">Serial.begin()</span></code></p>
</div>
<div class="codehilite"><pre><span></span><span class="n">Homie</span><span class="o">&amp;</span> <span class="n">disableLedFeedback</span><span class="p">();</span>
</pre></div>

<p>Disable the built-in LED feedback indicating the Homie for ESP8266 state.</p>
<div class="codehilite"><pre><span></span><span class="n">Homie</span><span class="o">&amp;</span> <span class="n">setLedPin</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">pin</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">on</span><span class="p">);</span>
</pre></div>

<p>Set pin of the LED to control.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">pin</span></code></strong>: LED to control</li>
<li><strong><code class="codehilite"><span class="err">on</span></code></strong>: state when the light is on (HIGH or LOW)</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">Homie</span><span class="o">&amp;</span> <span class="n">setConfigurationApPassword</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">password</span><span class="p">);</span>
</pre></div>

<p>Set the configuration AP password.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">password</span></code></strong>: the configuration AP password</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">Homie</span><span class="o">&amp;</span> <span class="n">setGlobalInputHandler</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">bool</span><span class="p">(</span><span class="k">const</span> <span class="n">String</span><span class="o">&amp;</span> <span class="n">nodeId</span><span class="p">,</span> <span class="k">const</span> <span class="n">String</span><span class="o">&amp;</span> <span class="n">property</span><span class="p">,</span> <span class="k">const</span> <span class="n">HomieRange</span><span class="o">&amp;</span> <span class="n">range</span><span class="p">,</span> <span class="k">const</span> <span class="n">String</span><span class="o">&amp;</span> <span class="n">value</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">handler</span><span class="p">);</span>
</pre></div>

<p>Set input handler for subscribed properties.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">handler</span></code></strong>: Global input handler</li>
<li><strong><code class="codehilite"><span class="err">node</span></code></strong>: Name of the node getting updated</li>
<li><strong><code class="codehilite"><span class="err">property</span></code></strong>: Property of the node getting updated</li>
<li><strong><code class="codehilite"><span class="err">range</span></code></strong>: Range of the property of the node getting updated</li>
<li><strong><code class="codehilite"><span class="err">value</span></code></strong>: Value of the new property</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">Homie</span><span class="o">&amp;</span> <span class="n">setBroadcastHandler</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">bool</span><span class="p">(</span><span class="k">const</span> <span class="n">String</span><span class="o">&amp;</span> <span class="n">level</span><span class="p">,</span> <span class="k">const</span> <span class="n">String</span><span class="o">&amp;</span> <span class="n">value</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">handler</span><span class="p">);</span>
</pre></div>

<p>Set broadcast handler.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">handler</span></code></strong>: Broadcast handler</li>
<li><strong><code class="codehilite"><span class="err">level</span></code></strong>: Level of the broadcast</li>
<li><strong><code class="codehilite"><span class="err">value</span></code></strong>: Value of the broadcast</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">Homie</span><span class="o">&amp;</span> <span class="n">onEvent</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="k">const</span> <span class="n">HomieEvent</span><span class="o">&amp;</span> <span class="n">event</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">callback</span><span class="p">);</span>
</pre></div>

<p>Set the event handler. Useful if you want to hook to Homie events.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">callback</span></code></strong>: Event handler</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">Homie</span><span class="o">&amp;</span> <span class="n">setResetTrigger</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">pin</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">state</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">time</span><span class="p">);</span>
</pre></div>

<p>Set the reset trigger. By default, the device will reset when pin <code class="codehilite"><span class="err">0</span></code> is <code class="codehilite"><span class="err">LOW</span></code> for <code class="codehilite"><span class="err">5000</span></code>ms.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">pin</span></code></strong>: Pin of the reset trigger</li>
<li><strong><code class="codehilite"><span class="err">state</span></code></strong>: Reset when the pin reaches this state for the given time</li>
<li><strong><code class="codehilite"><span class="err">time</span></code></strong>: Time necessary to reset</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">Homie</span><span class="o">&amp;</span> <span class="n">disableResetTrigger</span><span class="p">();</span>
</pre></div>

<p>Disable the reset trigger.</p>
<div class="codehilite"><pre><span></span><span class="n">Homie</span><span class="o">&amp;</span> <span class="n">setSetupFunction</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">()</span><span class="o">&gt;</span> <span class="n">callback</span><span class="p">);</span>
</pre></div>

<p>You can provide the function that will be called when operating in <code class="codehilite"><span class="err">normal</span></code> mode.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">callback</span></code></strong>: Setup function</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">Homie</span><span class="o">&amp;</span> <span class="n">setLoopFunction</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">()</span><span class="o">&gt;</span> <span class="n">callback</span><span class="p">);</span>
</pre></div>

<p>You can provide the function that will be looped in normal mode.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">callback</span></code></strong>: Loop function</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">Homie</span><span class="o">&amp;</span> <span class="n">setStandalone</span><span class="p">();</span>
</pre></div>

<p>This will mark the Homie firmware as standalone, meaning it will first boot in <code class="codehilite"><span class="err">standalone</span></code> mode. To configure it and boot to <code class="codehilite"><span class="err">configuration</span></code> mode, the device has to be resetted.</p>
<h2 id="functions-to-call-after-homiesetup">Functions to call <em>after</em> <code class="codehilite"><span class="err">Homie.setup()</span></code><a class="headerlink" href="#functions-to-call-after-homiesetup" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="nf">reset</span><span class="p">();</span>
</pre></div>

<p>Flag the device for reset.</p>
<div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="nf">setIdle</span><span class="p">(</span><span class="kt">bool</span> <span class="n">idle</span><span class="p">);</span>
</pre></div>

<p>Set the device as idle or not. This is useful at runtime, because you might want the device not to be resettable when you have another library that is doing some unfinished work, like moving shutters for example.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">idle</span></code></strong>: Device in an idle state or not</li>
</ul>
<div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="nf">prepareToSleep</span><span class="p">();</span>
</pre></div>

<p>Prepare the device for deep sleep. It ensures messages are sent and disconnects cleanly from the MQTT broker, triggering a <code class="codehilite"><span class="err">READY_TO_SLEEP</span></code> event when done.</p>
<div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="nf">doDeepSleep</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">time_us</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">RFMode</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">RF_DEFAULT</span><span class="p">);</span>
</pre></div>

<p>Puth the device into deep sleep. It ensures the Serial is flushed.</p>
<div class="codehilite"><pre><span></span><span class="kt">bool</span> <span class="nf">isConfigured</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
</pre></div>

<p>Is the device in <code class="codehilite"><span class="err">normal</span></code> mode, configured?</p>
<div class="codehilite"><pre><span></span><span class="kt">bool</span> <span class="nf">isConnected</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
</pre></div>

<p>Is the device in <code class="codehilite"><span class="err">normal</span></code> mode, configured and connected?</p>
<div class="codehilite"><pre><span></span><span class="k">const</span> <span class="n">ConfigStruct</span><span class="o">&amp;</span> <span class="n">getConfiguration</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
</pre></div>

<p>Get the configuration struct.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Be careful with this struct, never attempt to change it.</p>
</div>
<div class="codehilite"><pre><span></span><span class="n">AsyncMqttClient</span><span class="o">&amp;</span> <span class="n">getMqttClient</span><span class="p">();</span>
</pre></div>

<p>Get the underlying <code class="codehilite"><span class="err">AsyncMqttClient</span></code> object.</p>
<div class="codehilite"><pre><span></span><span class="n">Logger</span><span class="o">&amp;</span> <span class="n">getLogger</span><span class="p">();</span>
</pre></div>

<p>Get the underlying <code class="codehilite"><span class="err">Logger</span></code> object, which is only a wrapper around <code class="codehilite"><span class="err">Serial</span></code> by default.</p>
<hr />
<h1 id="homienode">HomieNode<a class="headerlink" href="#homienode" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><span class="n">HomieNode</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">id</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">type</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">bool</span><span class="p">(</span><span class="k">const</span> <span class="n">String</span><span class="o">&amp;</span> <span class="n">property</span><span class="p">,</span> <span class="k">const</span> <span class="n">HomieRange</span><span class="o">&amp;</span> <span class="n">range</span><span class="p">,</span> <span class="k">const</span> <span class="n">String</span><span class="o">&amp;</span> <span class="n">value</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">handler</span> <span class="o">=</span> <span class="p">);</span>
</pre></div>

<p>Constructor of an HomieNode object.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">id</span></code></strong>: ID of the node</li>
<li><strong><code class="codehilite"><span class="err">type</span></code></strong>: Type of the node</li>
<li><strong><code class="codehilite"><span class="err">handler</span></code></strong>: Optional. Input handler of the node</li>
</ul>
<div class="codehilite"><pre><span></span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">getId</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
</pre></div>

<p>Return the ID of the node.</p>
<div class="codehilite"><pre><span></span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">getType</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
</pre></div>

<p>Return the type of the node.</p>
<div class="codehilite"><pre><span></span><span class="n">PropertyInterface</span><span class="o">&amp;</span> <span class="n">advertise</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">property</span><span class="p">);</span>
<span class="n">PropertyInterface</span><span class="o">&amp;</span> <span class="n">advertiseRange</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">property</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">lower</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">upper</span><span class="p">);</span>
</pre></div>

<p>Advertise a property / range property on the node.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">property</span></code></strong>: Property to advertise</li>
<li><strong><code class="codehilite"><span class="err">lower</span></code></strong>: Lower bound of the range</li>
<li><strong><code class="codehilite"><span class="err">upper</span></code></strong>: Upper bound of the range</li>
</ul>
<p>This returns a reference to <code class="codehilite"><span class="err">PropertyInterface</span></code> on which you can call:</p>
<div class="codehilite"><pre><span></span><span class="kt">void</span> <span class="nf">settable</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">bool</span><span class="p">(</span><span class="k">const</span> <span class="n">HomieRange</span><span class="o">&amp;</span> <span class="n">range</span><span class="p">,</span> <span class="k">const</span> <span class="n">String</span><span class="o">&amp;</span> <span class="n">value</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">handler</span><span class="p">)</span> <span class="o">=</span> <span class="p">);</span>
</pre></div>

<p>Make the property settable.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">handler</span></code></strong>: Optional. Input handler of the property</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">SendingPromise</span><span class="o">&amp;</span> <span class="n">setProperty</span><span class="p">(</span><span class="k">const</span> <span class="n">String</span><span class="o">&amp;</span> <span class="n">property</span><span class="p">);</span>
</pre></div>

<p>Using this function, you can set the value of a node property, like a temperature for example.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">property</span></code></strong>: Property to send</li>
</ul>
<p>This returns a reference to <code class="codehilite"><span class="err">SendingPromise</span></code>, on which you can call:</p>
<div class="codehilite"><pre><span></span><span class="n">SendingPromise</span><span class="o">&amp;</span> <span class="n">setQos</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">qos</span><span class="p">);</span>  <span class="c1">// defaults to 1</span>
<span class="n">SendingPromise</span><span class="o">&amp;</span> <span class="n">setRetained</span><span class="p">(</span><span class="kt">bool</span> <span class="n">retained</span><span class="p">);</span>  <span class="c1">// defaults to true</span>
<span class="n">SendingPromise</span><span class="o">&amp;</span> <span class="n">overwriteSetter</span><span class="p">(</span><span class="kt">bool</span> <span class="n">overwrite</span><span class="p">);</span>  <span class="c1">// defaults to false</span>
<span class="n">SendingPromise</span><span class="o">&amp;</span> <span class="n">setRange</span><span class="p">(</span><span class="k">const</span> <span class="n">HomieRange</span><span class="o">&amp;</span> <span class="n">range</span><span class="p">);</span>  <span class="c1">// defaults to not a range</span>
<span class="n">SendingPromise</span><span class="o">&amp;</span> <span class="n">setRange</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="n">rangeIndex</span><span class="p">);</span>  <span class="c1">// defaults to not a range</span>
<span class="kt">uint16_t</span> <span class="nf">send</span><span class="p">(</span><span class="k">const</span> <span class="n">String</span><span class="o">&amp;</span> <span class="n">value</span><span class="p">);</span>  <span class="c1">// finally send the property, return the packetId (or 0 if failure)</span>
</pre></div>

<p>Method names should be self-explanatory.</p>
<h1 id="homiesetting">HomieSetting<a class="headerlink" href="#homiesetting" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><span class="n">HomieSetting</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">description</span><span class="p">);</span>
</pre></div>

<p>Constructor of an HomieSetting object.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">T</span></code></strong>: Type of the setting. Either <code class="codehilite"><span class="err">bool</span></code>, <code class="codehilite"><span class="err">unsigned long</span></code>, <code class="codehilite"><span class="err">long</span></code>, <code class="codehilite"><span class="err">double</span></code> or <code class="codehilite"><span class="err">const char*</span></code></li>
<li><strong><code class="codehilite"><span class="err">name</span></code></strong>: Name of the setting</li>
<li><strong><code class="codehilite"><span class="err">description</span></code></strong>: Description of the setting</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">T</span> <span class="nf">get</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
</pre></div>

<p>Get the default value if the setting is optional and not provided, or the provided value if the setting is required or optional but provided.</p>
<div class="codehilite"><pre><span></span><span class="kt">bool</span> <span class="nf">wasProvided</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
</pre></div>

<p>Return whether the setting was provided or not (otherwise <code class="codehilite"><span class="err">get()</span></code> would return the default value).</p>
<p>Set the default value and make the setting optional.</p>
<div class="codehilite"><pre><span></span><span class="n">HomieSetting</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span> <span class="n">setDefaultValue</span><span class="p">(</span><span class="n">T</span> <span class="n">defaultValue</span><span class="p">);</span>
</pre></div>

<ul>
<li><strong><code class="codehilite"><span class="err">defaultValue</span></code></strong>: The default value</li>
</ul>
<div class="codehilite"><pre><span></span><span class="n">HomieSetting</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span> <span class="n">setValidator</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">bool</span><span class="p">(</span><span class="n">T</span> <span class="n">candidate</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">validator</span><span class="p">);</span>
</pre></div>

<p>Set a validation function for the setting. The validator must return <code class="codehilite"><span class="err">true</span></code> if the candidate is correct, <code class="codehilite"><span class="err">false</span></code> otherwise.</p>
<ul>
<li><strong><code class="codehilite"><span class="err">validator</span></code></strong>: The validation function</li>
</ul>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../troubleshooting/" title="Troubleshooting" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Troubleshooting
              </span>
            </div>
          </a>
        
        
          <a href="../upgrade-guide-from-v1-to-v2/" title="Upgrade guide from v1 to v2" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Upgrade guide from v1 to v2
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="http://homieiot.github.io/homie-esp8266/configurators/v2/" class="md-footer-social__link fa fa-cog"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>